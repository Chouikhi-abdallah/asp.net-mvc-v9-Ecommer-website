@model IEnumerable<Proj.Models.Product>
@{
ViewData["Title"] = "Welcome, " + ViewBag.UserName;
}

<!-- Top Navbar -->
<div class="main-navbar shadow-sm sticky-top">
    <div class="top-navbar bg-primary text-white">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-2 my-auto d-none d-sm-none d-md-block d-lg-block">
                    <h5 class="brand-name">AC E-COMMERCE</h5>
                </div>
                <div class="col-md-5 my-auto">
                    <form method="get" action="@Url.Action("CustomerHome", "Customer")">
                        <div class="input-group">
                            <input type="search" name="search" placeholder="Search your product" class="form-control" value="@ViewBag.SearchTerm" />
                            <button class="btn bg-white" type="submit">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                    </form>
                </div>
                <div class="col-md-5 my-auto">
                    <ul class="nav justify-content-end">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="/Customer/Cart">
                                <i class="fa fa-shopping-cart"></i> Cart
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link text-white dropdown-toggle" href="#x" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-user"></i> @ViewBag.UserName
                            </a>
                            <!-- Dropdown Menu -->
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown" id="x">
                                <li><a class="dropdown-item" href="/Account/UpdateProfile"> Profile</a></li>
                                <li><a class="dropdown-item" href="/Account/Logout">Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Sidebar with Categories -->
<div class="container-fluid mt-4">
    <div class="row">
        <!-- Left Sidebar -->
        <div class="col-md-3 col-lg-2 p-3 sidebar bg-light">
            <h5 class="font-weight-bold">Categories</h5>
            <ul class="list-group">
                <li class="list-group-item">
                    <a href="@Url.Action("CustomerHome", "Customer")">All Categories</a>
                </li>
                @foreach (var category in ViewBag.Categories as List<Proj.Models.Category>)
                {
                <li class="list-group-item">
                    <a href="@Url.Action("CustomerHome", "Customer", new { categoryId = category.Id })">@category.Name</a>
                </li>
                }
            </ul>
        </div>

        <!-- Main Content Area -->
        <div class="col-md-9 col-lg-10 p-4">
            <!-- Products Section -->
            <!-- Products Section -->
            <h2 class="text-center mb-4">Available Products</h2>
            <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
                @foreach (var product in Model)
                {
                <div class="col">
                    <div class="card mx-auto col-md-3 col-10 mt-5">
                        <img class="mx-auto img-thumbnail" src="@product.ImagePath" width="50" height="50" />
                        <div class="card-body text-center mx-auto">
                            <div class="cvp">
                                <h5 class="card-title font-weight-bold">@product.Name</h5>
                                <p class="card-text">$@product.Price</p>
                                <a href="/Customer/ConsultProduct/@product.Id" class="btn details px-auto">View Details</a><br />
                                @if (product.Quantity > 0)
                                {
                                <form method="post" action="@Url.Action("AddToCart", "Customer")">
                                    <input type="hidden" name="productId" value="@product.Id" />
                                    <input type="hidden" name="quantity" value="1" />
                                    <button type="submit" class="btn cart px-auto">Add to Cart</button>
                                </form>
                                }
                                else
                                {
                                <button class="btn cart w-100" disabled>Out of Stock</button>
                                }
                            </div>
                        </div>
                    </div>
                </div>
                }
            </div>

            <!-- Pagination Controls -->
            <div class="pagination-container text-center mt-4">
                <ul class="pagination">
                    @if (ViewBag.CurrentPage > 1)
                    {
                    <li class="page-item">
                        <a class="page-link" href="@Url.Action("CustomerHome", "Customer", new { page = ViewBag.CurrentPage - 1, search = ViewBag.SearchTerm, categoryId = ViewBag.SelectedCategoryId })">Previous</a>
                    </li>
                    }
                    @for (int i = 1; i <= ViewBag.TotalPages; i++)
                    {
                    <li class="page-item @(i == ViewBag.CurrentPage ? "active" : "")">
                        <a class="page-link" href="@Url.Action("CustomerHome", "Customer", new { page = i, search = ViewBag.SearchTerm, categoryId = ViewBag.SelectedCategoryId })">@i</a>
                    </li>
                    }
                    @if (ViewBag.CurrentPage < ViewBag.TotalPages)
                    {
                    <li class="page-item">
                        <a class="page-link" href="@Url.Action("CustomerHome", "Customer", new { page = ViewBag.CurrentPage + 1, search = ViewBag.SearchTerm, categoryId = ViewBag.SelectedCategoryId })">Next</a>
                    </li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS for Dropdown Functionality -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<style>
    body {
        background: #E0E0E0;
    }

    .top-navbar {
        background-color: #007bff; /* Blue */
        color: white;
    }

    .sidebar {
        position: sticky;
        top: 0;
        height: 100vh;
        overflow-y: auto;
    }

    .sidebar h5 {
        font-size: 1.25rem;
    }

    .sidebar .list-group-item {
        padding: 10px 15px;
        border: none;
    }

    .sidebar a {
        text-decoration: none;
        color: #212121;
    }

    .sidebar a:hover {
        color: #007bff;
    }

    .details {
        border: 1.5px solid grey;
        color: #212121;
        width: 100%;
        height: auto;
        box-shadow: 0px 0px 10px #212121;
    }

    .cart {
        background-color: #212121;
        color: white;
        margin-top: 10px;
        font-size: 12px;
        font-weight: 900;
        width: 100%;
        height: 39px;
        padding-top: 9px;
        box-shadow: 0px 5px 10px #212121;
    }

    .card {
        box-shadow: 0 20px 40px rgba(0, 0, 0, .2);
        border-radius: 5px;
        padding-bottom: 10px;
        width: 100%;
        margin: 0 auto;
    }

    .card-body {
        text-align: center;
    }

    .card-title {
        font-size: 18px;
        font-weight: bold;
    }

    .card-text {
        font-size: 16px;
        font-weight: 500;
    }

    .img-thumbnail {
        border: none;
        width: 100%;
        height: auto;
        object-fit: cover;
        max-height: 200px;
    }

    .cvp {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .btn {
        border-radius: 0;
    }

    /* Dropdown styles */
    .dropdown-menu {
        background-color: blue !important; /* White background */
        border: 1px solid #007bff; /* Blue border */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Optional: Add shadow for depth */
    }

    .dropdown-item:hover {
        background-color: #007bff;
        color: white;
    }
</style>
